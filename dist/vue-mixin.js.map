{"version":3,"file":"vue-mixin.js","sources":["../src/install.js","../src/utils.js","../src/vueMixin.js","../src/vueMixinFetchDetail.js","../src/vueMixinFetchList.js","../src/vueMixinStore.js","../src/index.js"],"sourcesContent":["export let _Vue\n\nexport default function install (Vue) {\n  if (install.installed) return\n  install.installed = true\n  _Vue = Vue\n}\n","export default {\n  isObject (obj) {\n    return Object.prototype.toString.call(obj) === '[object Object]'\n  },\n  isArray (arr) {\n    return Object.prototype.toString.call(arr) === '[object Array]'\n  },\n  isHas (obj, k) {\n    return Object.prototype.hasOwnProperty.call(obj, k)\n  },\n  createComputed (store) {\n    const computed = {}\n    Object.keys(store).forEach((k) => {\n      computed[k] = {\n        get () {\n          return store[k]\n        },\n        set (v) {\n          store[k] = v\n        }\n      }\n    })\n    return computed\n  }\n}\n","import { _Vue } from './install'\nimport utils from './utils'\n/**\n * vue mixin插件\n * return {Class}\n */\nexport default class VueMixin {\n  constructor (options) {\n    this.mixins = {}\n    this.store = {}\n    this.plugins = options.plugins || []\n\n    // 创建Vue实例\n    this.vm = new _Vue({\n      data: {\n        store: this.store\n      }\n    })\n    // 安装插件\n    this.plugins.forEach((item) => {\n      if (process.env.NODE_ENV !== 'production') {\n        if (typeof item.name !== 'string' || this.mixins[item.name]) {\n          return new Error({ msg: `[VueMixin] Plug in conflict [${item.name}]` })\n        }\n      }\n      this.mixins[item.name] = Object.assign(item.install(this))\n      if (utils.isObject(item.store)) {\n        this.createStore(item.name, item.store)\n      }\n    })\n  }\n  createStore (name, store) { // 创建仓库\n    _Vue.set(this.store, name, store)\n  }\n  destroyed () { // 销毁程序，释放内存\n    this.plugins.forEach((item) => { // 销毁插件\n      if (typeof item.destroyed === 'function') {\n        item.destroyed()\n      }\n    })\n    this.vm.destroyed() // 销毁vm\n  }\n}\n","import utils from './utils'\n/**\n * 详情，修改，新增可共用的mixin\n * 路由匹配规则：\n * /module\n * /module/create\n * /module/:id/edit\n * /module/:id\n * @param {Object} options 选项\n *  - {String} [key] - 详情的id的key路径\n *  - {Object|Array} [mixins] - 加入你自定义的mixins\n *  - {Function} [fetch] - 请求列表的调用的钩子函数，需要return Promise 类型\n *  - {Function} [model] - 数据的字段集合\n * @return {Object}\n */\nexport default function vueMixinFetchDetail (options) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof options.fetch !== 'function') {\n      return new Error({ msg: '[vueMixinFetchDetail] get options typeof function' })\n    }\n    if (typeof options.model !== 'function') {\n      return new Error({ msg: '[vueMixinFetchDetail] get options typeof function' })\n    }\n  }\n  // 处理key值\n  if (typeof options.key === 'string') {\n    const [detailName, keyName] = options.key.split('.')\n    options.detailName = detailName\n    options.keyName = keyName\n  } else {\n    return\n  }\n  // 处理mixins\n  if (utils.isObject(options.mixins)) {\n    options.mixins = [options.mixins]\n  } else if (!utils.isArray(options.mixins)) {\n    options.mixins = []\n  }\n  const name = 'fetchDetail'\n  const store = options.model()\n\n  return {\n    name,\n    store,\n    install (VueMixin) { // 安装程序\n      const { fetchList } = VueMixin.store\n      if (process.env.NODE_ENV !== 'production') {\n        if (!utils.isObject(fetchList)) {\n          return new Error({ msg: 'Please install the FetchList plugin' })\n        }\n      }\n      function getListItemIndex (key) { // 获取当前页面在列表中的索引，此处可使用算法来优化查找的性能、待续。。。\n        const { list, list: { length } } = fetchList\n        for (let i = 0; i < length; i++) {\n          if (String(list[i][options.keyName]) === String(key)) { // 路由传来的key可能是字符串，也可能是数字\n            return i\n          }\n        }\n        return -1\n      }\n\n      this.listUnwatch = VueMixin.vm.$watch('store.fetchList.list', (list) => { // 监听列表的数据改变\n        const index = getListItemIndex(store[options.detailName][options.keyName])\n        if (index < 0) return false\n        const detail = list[index]\n        Object.keys(store[options.detailName]).forEach((k) => {\n          if (Object.prototype.hasOwnProperty.call(detail, k)) { // 如果存在这个属性，才更新到详情中\n            store[options.detailName][k] = detail[k]\n          }\n        })\n      }, { deep: true })\n      this.detailUnwatch = VueMixin.vm.$watch(`store.${name}.${options.detailName}`, (detail) => { // 监听详情的数据改变\n        const index = getListItemIndex(store[options.detailName][options.keyName])\n        if (index < 0) return false\n        Object.keys(fetchList.list[index]).forEach((k) => {\n          fetchList.list[index][k] = detail[k]\n        })\n      }, { deep: true })\n      return {\n        mixins: options.mixins,\n        props: [options.keyName],\n        beforeRouteEnter (to, from, next) { // 每次路由变化都会调用此钩子函数\n          const toKey = String(to.params[options.keyName])\n          const key = String(store[options.detailName][options.keyName])\n          if (toKey !== key) { // 判断详情的数据和路由要跳转的页面是否一致\n            const index = getListItemIndex(to.params[options.keyName])\n            Object.assign(store, options.model(), { [options.detailName]: fetchList.list[index] || {} })\n          }\n          next()\n        },\n        computed: {\n          ...utils.createComputed(store),\n          $fetchDetail () {\n            const self = this\n            function fetchDetail () {\n              if (!self[options.keyName]) return\n              return options.fetch.call(self).then((res) => {\n                Object.assign(store, res)\n              })\n            }\n            return fetchDetail\n          }\n        },\n        created () {\n          this.$fetchDetail()\n        },\n        watch: {\n          [options.keyName] () {\n            this.$fetchDetail()\n          }\n        }\n      }\n    },\n    destroyed () { // 销毁插件，释放内存\n      this.listUnwatch()\n      this.detailUnwatch()\n    }\n  }\n}\n","import utils from './utils'\n/**\n * vue列表使用的mixin\n * @param {Object} options\n *  - {String} [pagekey] - 分页的唯一标识\n *  - {String} [queryKey] - 地址栏参数的key\n *  - {Function} [fetch] - 请求列表的调用的钩子函数，需要return Promise 类型\n *  - {Function} [model] - 列表的字段模型\n * @return {Object}\n */\nexport default function vueMixinFetchList (options) {\n  // 必传选项验证\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof options.pagekey !== 'string') {\n      return new Error({ msg: '[vueMixinFetchList] get options typeof string' })\n    }\n    if (typeof options.queryKey !== 'string') {\n      return new Error({ msg: '[vueMixinFetchList] get options typeof string' })\n    }\n    if (typeof options.fetch !== 'function') {\n      return new Error({ msg: '[vueMixinFetchList] get options typeof function' })\n    }\n    if (typeof options.model !== 'function') {\n      return new Error({ msg: '[vueMixinFetchList] get options typeof function' })\n    }\n  }\n  const name = 'fetchList'\n  const store = options.model()\n\n  return {\n    name,\n    store,\n    install (VueMixin) { // 安装程序\n      let dataSearch = ''\n      return {\n        beforeRouteEnter (to, from, next) {\n          // 如果不是在当前模块内跳转，并且列表关联的key和现在的key不一致，则清除数据)\n          if (getSearch(to.query) !== dataSearch) {\n            listInit()\n          }\n          next()\n        },\n        computed: {\n          ...utils.createComputed(store),\n          $fetchList () {\n            const self = this\n            /**\n             * 获取列表的数据\n             */\n            function fetchList () {\n              const search = getSearch(self.$route.query)\n              return options.fetch.call(self).then((res) => {\n                if (search !== getSearch(self.$route.query)) return false // 数据请求回来，页面已经发生改变了\n                Object.assign(store, res)\n                dataSearch = search\n              })\n            }\n            fetchList.init = function init () {\n              listInit.apply(self, arguments)\n            }\n            /**\n             * 查询页面的数据\n             */\n            fetchList.search = function search (...arg) {\n              let query = {}\n              /* eslint-disable no-undef */\n              if (event === arg[0]) { // 事件触发传进来的参数不要\n                arg[0] = {}\n              }\n              if (utils.isObject(arg[0])) {\n                query = arg[0]\n              } else if (typeof arg[0] === 'string') {\n                query[arg[0]] = arg[1]\n              }\n              query = Object.assign({}, self.$route.query, { [options.pagekey]: 1 }, self[options.queryKey], query)\n              self.$router.push({\n                ...this.$route,\n                query\n              })\n            }\n            /**\n             * 将地址栏的参数同步到组件中\n             */\n            fetchList.syncQuery = function syncQuery () {\n              const query = self[options.queryKey]\n              if (utils.isObject(query)) { // 将地址栏的参数，还原到对应的字段中去\n                Object.keys(query).forEach((k) => {\n                  if (Object.prototype.hasOwnProperty.call(self.$route.query, k)) {\n                    query[k] = self.$route.query[k]\n                  }\n                })\n              }\n            }\n            return fetchList\n          }\n        },\n        created () {\n          this.$fetchList.syncQuery()\n          this.$fetchList()\n        },\n        watch: {\n          '$route.query' (val, oldVal) {\n            this.$fetchList.syncQuery()\n            if (getSearch(val) === getSearch(oldVal)) return false // 对象被改变了，但是url并没有改变\n            this.$fetchList()\n          }\n        }\n      }\n    },\n    destroyed (VueMixin) { // 卸载程序\n    }\n  }\n\n  function getSearch (query) { // 获取地址栏?后面的参数\n    const arr = []\n    Object.keys(query).forEach((k) => arr.push(`${k}=${query[k]}`))\n    return arr.join('&')\n  }\n  function listInit () { // 初始化状态\n    const model = options.model()\n    Object.assign(store, model)\n  }\n}\n","import { _Vue } from './install'\nimport utils from './utils'\n/**\n * 缓存列表的数据\n * @param {Array} options\n * - {Array} [base] - 依赖其他的请求\n * - {Boolean} [update] - 是否更新数据\n * - {Function} [fetch] - 请求数据\n */\nexport default function vueMixinStore (options) {\n  const name = 'store'\n  const store = {} // 仓库，所有的数据存储在这里\n  const task = {} // 所有的任务\n  /**\n   * 一项默认的配置\n   */\n  const defaults = {\n    base: [], // 这一项，基于谁\n    update: true, // 是否更新数据\n    fetch: () => Promise.resolve({}) // 处理请求的钩子函数可以依赖其他请求\n  }\n  Object.keys(options).forEach((k) => {\n    const unknown = options[k]\n    if (utils.isObject(unknown)) {\n      task[k] = Object.assign({}, defaults, unknown)\n    } else if (typeof unknown === 'function') {\n      task[k] = Object.assign({}, defaults, { fetch: unknown })\n    }\n  })\n  return {\n    name,\n    store,\n    install (VueMixin) {\n      return {\n        created () {\n          const fetchTask = {} // 仓库的请求任务\n\n          Object.keys(task).forEach((k) => {\n            if (!utils.isHas(this.$data, k)) return false // 组件没有使用这个仓库的数据\n            if (utils.isHas(store, k)) { // 仓库已经存在数据\n              this.$data[k] = store[k] // 从仓库中还原数据\n            } else {\n              _Vue.set(store, k, this.$data[k]) // 在仓库中创建默认的数据\n            }\n            const item = task[k]\n            const data = store[k]\n            if (!item.update && data._ok_) return false // 数据无需更新\n            if (item.base.length === 0) {\n              fetchTask[k] = item\n            } else {\n              // 将依赖的任务添加进来\n              addBaseTask(item.base)\n            }\n          })\n\n          vueMixinStoreFetch.call(this, fetchTask)\n          function addBaseTask (base) {\n            base.forEach((k) => {\n              fetchTask[k] = task[k]\n            })\n          }\n          function vueMixinStoreFetch (fetchTask) {\n            const fetch = []\n            const queue = Object.keys(fetchTask)\n            const storeUpdate = (k, data) => {\n              Object.defineProperty(data, '_ok_', { // 此数据是否是已经加载过了\n                value: true,\n                enumerable: false, // 不可枚举\n                configurable: false, // 属性不可删除\n                writable: true // 值允许可写\n              })\n              this.$data[k] = store[k] = data\n            }\n\n            queue.forEach((k) => {\n              const item = fetchTask[k]\n              const promise = item.fetch.call(this).then((res) => {\n                storeUpdate(k, res)\n                return res\n              })\n              fetch.push(promise)\n            })\n            return Promise.all(fetch).then((arg) => {\n              Object.keys(task).forEach((k) => {\n                const list = []\n                const item = task[k]\n                if (!item.base.length) return false // 没有依赖任务\n                for (let i = 0; i < item.base.length; i++) {\n                  const index = queue.indexOf(item.base[i])\n                  if (index > -1) {\n                    list.push(arg[index])\n                  } else {\n                    break\n                  }\n                }\n                if (list.length === item.base.length) { // 执行依赖的任务\n                  storeUpdate(k, item.fetch.apply(this, list))\n                }\n              })\n            })\n          }\n        },\n        computed: {\n          $vueMixinStore () {\n            return store\n          }\n        }\n      }\n    }\n  }\n}\n","import install from './install'\nimport VueMixin from './vueMixin'\nexport { default as vueMixinFetchDetail } from './vueMixinFetchDetail'\nexport { default as vueMixinFetchList } from './vueMixinFetchList'\nexport { default as vueMixinStore } from './vueMixinStore'\n\nexport default VueMixin\n\nVueMixin.install = install\n"],"names":["_Vue","install","Vue","installed","obj","Object","prototype","toString","call","arr","k","hasOwnProperty","store","computed","keys","forEach","v","VueMixin","options","mixins","plugins","vm","item","process","env","NODE_ENV","name","Error","msg","assign","utils","isObject","createStore","set","destroyed","vueMixinFetchDetail","fetch","model","key","split","detailName","keyName","isArray","fetchList","getListItemIndex","list","length","i","String","listUnwatch","$watch","index","detail","deep","detailUnwatch","to","from","next","toKey","params","createComputed","self","fetchDetail","then","res","$fetchDetail","vueMixinFetchList","pagekey","queryKey","dataSearch","getSearch","query","search","$route","init","apply","arguments","arg","event","$router","push","syncQuery","$fetchList","val","oldVal","join","listInit","vueMixinStore","task","defaults","Promise","resolve","unknown","fetchTask","isHas","$data","data","update","_ok_","base","addBaseTask","vueMixinStoreFetch","queue","storeUpdate","defineProperty","promise","all","indexOf"],"mappings":"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"}