{"version":3,"file":"vue-mixin.js","sources":["../src/install.js","../src/utils.js","../src/vueMixin.js","../src/vueMixinFetchDetail.js","../src/vueMixinFetchList.js","../src/vueMixinStore.js","../src/index.js"],"sourcesContent":["export let _Vue\n\nexport default function install (Vue) {\n  if (install.installed) return\n  install.installed = true\n  _Vue = Vue\n}\n","export default {\n  isObject (obj) {\n    return Object.prototype.toString.call(obj) === '[object Object]'\n  },\n  isArray (arr) {\n    return Object.prototype.toString.call(arr) === '[object Array]'\n  },\n  isHas (obj, k) {\n    return Object.prototype.hasOwnProperty.call(obj, k)\n  },\n  createComputed (store) {\n    const computed = {}\n    Object.keys(store).forEach((k) => {\n      computed[k] = {\n        get () {\n          return store[k]\n        },\n        set (v) {\n          store[k] = v\n        }\n      }\n    })\n    return computed\n  }\n}\n","import { _Vue } from './install'\nimport utils from './utils'\n/**\n * vue mixin插件\n * return {Class}\n */\nexport default class VueMixin {\n  constructor (options) {\n    this.mixins = {}\n    this.store = {}\n    this.plugins = options.plugins || []\n\n    // 创建Vue实例\n    this.vm = new _Vue({\n      data: {\n        store: this.store\n      }\n    })\n    // 安装插件\n    this.plugins.forEach((item) => {\n      if (process.env.NODE_ENV !== 'production') {\n        if (typeof item.name !== 'string' || this.mixins[item.name]) {\n          return new Error({ msg: `[VueMixin] Plug in conflict [${item.name}]` })\n        }\n      }\n      this.mixins[item.name] = Object.assign(item.install(this))\n      if (utils.isObject(item.store)) {\n        this.createStore(item.name, item.store)\n      }\n    })\n  }\n  createStore (name, store) { // 创建仓库\n    _Vue.set(this.store, name, store)\n  }\n  destroyed () { // 销毁程序，释放内存\n    this.plugins.forEach((item) => { // 销毁插件\n      if (typeof item.destroyed === 'function') {\n        item.destroyed()\n      }\n    })\n    this.vm.destroyed() // 销毁vm\n  }\n}\n","import utils from './utils'\n/**\n * 详情，修改，新增可共用的mixin\n * 路由匹配规则：\n * /module\n * /module/create\n * /module/:id/edit\n * /module/:id\n * @param {Object} options 选项\n *  - {String} [key] - id的唯一标识\n *  - {Function} [fetch] - 请求列表的调用的钩子函数，需要return Promise 类型\n *  - {Function} [model] - 数据的字段集合\n * @return {Object}\n */\nexport default function vueMixinFetchDetail (options) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof options.fetch !== 'function') {\n      return new Error({ msg: '[vueMixinFetchDetail] get options typeof function' })\n    }\n    if (typeof options.model !== 'function') {\n      return new Error({ msg: '[vueMixinFetchDetail] get options typeof function' })\n    }\n  }\n  if (options.key === undefined) { // 列表和详情唯一的id键值，不可重复\n    options.key = 'id'\n  }\n  const name = 'fetchDetail'\n  const store = {\n    detail: options.model()\n  }\n\n  return {\n    name,\n    store,\n    install (VueMixin) { // 安装程序\n      const { fetchList } = VueMixin.store\n      if (process.env.NODE_ENV !== 'production') {\n        if (!utils.isObject(fetchList)) {\n          return new Error({ msg: 'Please install the FetchList plugin' })\n        }\n      }\n      function getListItemIndex (key) { // 获取当前页面在列表中的索引，此处可使用算法来优化查找的性能、待续。。。\n        const { list, list: { length } } = fetchList\n        for (let i = 0; i < length; i++) {\n          if (String(list[i][options.key]) === String(key)) { // 路由传来的key可能是字符串，也可能是数字\n            return i\n          }\n        }\n        return -1\n      }\n\n      this.listUnwatch = VueMixin.vm.$watch('store.fetchList.list', (list) => { // 监听列表的数据改变\n        const index = getListItemIndex(store.detail[options.key])\n        if (index < 0) return false\n        const detail = list[index]\n        Object.keys(store.detail).forEach((k) => {\n          if (Object.prototype.hasOwnProperty.call(detail, k)) { // 如果存在这个属性，才更新到详情中\n            store.detail[k] = detail[k]\n          }\n        })\n      }, { deep: true })\n      this.detailUnwatch = VueMixin.vm.$watch(`store.${name}.detail`, (detail) => { // 监听详情的数据改变\n        const index = getListItemIndex(store.detail[options.key])\n        if (index < 0) return false\n        Object.keys(fetchList.list[index]).forEach((k) => {\n          fetchList.list[index][k] = detail[k]\n        })\n      }, { deep: true })\n      return {\n        props: [options.key],\n        beforeRouteEnter (to, from, next) { // 每次路由变化都会调用此钩子函数\n          if (String(to.params[options.key]) !== String(store.detail[options.key])) { // 判断详情的数据和路由要跳转的页面是否一致\n            const index = getListItemIndex(to.params[options.key])\n            Object.assign(store.detail, options.model(), fetchList.list[index] || {})\n          }\n          next()\n        },\n        computed: {\n          ...utils.createComputed(store),\n          $fetchDetail () {\n            const self = this\n            function fetchDetail () {\n              if (!self[options.key]) return\n              return options.fetch.call(self).then((detail) => (store.detail = detail))\n            }\n            return fetchDetail\n          }\n        },\n        created () {\n          this.$fetchDetail()\n        },\n        watch: {\n          [options.key] () {\n            this.$fetchDetail()\n          }\n        }\n      }\n    },\n    destroyed () { // 销毁插件，释放内存\n      this.listUnwatch()\n      this.detailUnwatch()\n    }\n  }\n}\n","import utils from './utils'\n/**\n * vue列表使用的mixin\n * @param {Object} options\n *  - {String} [pagekey] - 分页的唯一标识\n *  - {String} [queryKey] - 地址栏参数的key\n *  - {Function} [fetch] - 请求列表的调用的钩子函数，需要return Promise 类型\n *  - {Function} [model] - 列表的字段模型\n * @return {Object}\n */\nexport default function vueMixinFetchList (options) {\n  // 必传选项验证\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof options.pagekey !== 'string') {\n      return new Error({ msg: '[vueMixinFetchList] get options typeof string' })\n    }\n    if (typeof options.queryKey !== 'string') {\n      return new Error({ msg: '[vueMixinFetchList] get options typeof string' })\n    }\n    if (typeof options.fetch !== 'function') {\n      return new Error({ msg: '[vueMixinFetchList] get options typeof function' })\n    }\n    if (typeof options.model !== 'function') {\n      return new Error({ msg: '[vueMixinFetchList] get options typeof function' })\n    }\n  }\n  const name = 'fetchList'\n  const store = options.model()\n\n  return {\n    name,\n    store,\n    install (VueMixin) { // 安装程序\n      let dataSearch = ''\n      return {\n        beforeRouteEnter (to, from, next) {\n          // 如果不是在当前模块内跳转，并且列表关联的key和现在的key不一致，则清除数据)\n          if (getSearch(to.query) !== dataSearch) {\n            listInit()\n          }\n          next()\n        },\n        computed: {\n          ...utils.createComputed(store),\n          $fetchList () {\n            const self = this\n            /**\n             * 获取列表的数据\n             */\n            function fetchList () {\n              const search = getSearch(self.$route.query)\n              return options.fetch.call(self).then((res) => {\n                if (search !== getSearch(self.$route.query)) return false // 数据请求回来，页面已经发生改变了\n                Object.assign(store, options.model(), res)\n                dataSearch = search\n              })\n            }\n            fetchList.init = function init () {\n              listInit.apply(self, arguments)\n            }\n            /**\n             * 查询页面的数据\n             */\n            fetchList.search = function search (...arg) {\n              let query = {}\n              /* eslint-disable no-undef */\n              if (event === arg[0]) { // 事件触发传进来的参数不要\n                arg[0] = {}\n              }\n              if (utils.isObject(arg[0])) {\n                query = arg[0]\n              } else if (typeof arg[0] === 'string') {\n                query[arg[0]] = arg[1]\n              }\n              query = Object.assign({}, self.$route.query, { [options.pagekey]: 1 }, self[options.queryKey], query)\n              self.$router.push({\n                ...this.$route,\n                query\n              })\n            }\n            /**\n             * 将地址栏的参数同步到组件中\n             */\n            fetchList.syncQuery = function syncQuery () {\n              const query = self[options.queryKey]\n              if (utils.isObject(query)) { // 将地址栏的参数，还原到对应的字段中去\n                Object.keys(query).forEach((k) => {\n                  if (Object.prototype.hasOwnProperty.call(self.$route.query, k)) {\n                    query[k] = self.$route.query[k]\n                  }\n                })\n              }\n            }\n            return fetchList\n          }\n        },\n        created () {\n          this.$fetchList.syncQuery()\n          this.$fetchList()\n        },\n        watch: {\n          '$route.query' (val, oldVal) {\n            this.$fetchList.syncQuery()\n            if (getSearch(val) === getSearch(oldVal)) return false // 对象被改变了，但是url并没有改变\n            this.$fetchList()\n          }\n        }\n      }\n    },\n    destroyed (VueMixin) { // 卸载程序\n    }\n  }\n\n  function getSearch (query) { // 获取地址栏?后面的参数\n    const arr = []\n    Object.keys(query).forEach((k) => arr.push(`${k}=${query[k]}`))\n    return arr.join('&')\n  }\n  function listInit () { // 初始化状态\n    const model = options.model()\n    Object.assign(store, model)\n  }\n}\n","import { _Vue } from './install'\nimport utils from './utils'\n/**\n * 缓存列表的数据\n * @param {Array} options\n * - {Array} [base] - 依赖其他的请求\n * - {Boolean} [update] - 是否更新数据\n * - {Function} [fetch] - 请求数据\n */\nexport default function vueMixinStore (options) {\n  const name = 'store'\n  const store = {} // 仓库，所有的数据存储在这里\n  const task = {} // 所有的任务\n  /**\n   * 一项默认的配置\n   */\n  const defaults = {\n    base: [], // 这一项，基于谁\n    update: true, // 是否更新数据\n    fetch: () => Promise.resolve({}) // 处理请求的钩子函数可以依赖其他请求\n  }\n  Object.keys(options).forEach((k) => {\n    const unknown = options[k]\n    if (utils.isObject(unknown)) {\n      task[k] = Object.assign({}, defaults, unknown)\n    } else if (typeof unknown === 'function') {\n      task[k] = Object.assign({}, defaults, { fetch: unknown })\n    }\n  })\n  return {\n    name,\n    store,\n    install (VueMixin) {\n      return {\n        created () {\n          const fetchTask = {} // 仓库的请求任务\n\n          Object.keys(task).forEach((k) => {\n            if (!utils.isHas(this.$data, k)) return false // 组件没有使用这个仓库的数据\n            if (utils.isHas(store, k)) { // 仓库已经存在数据\n              this.$data[k] = store[k] // 从仓库中还原数据\n            } else {\n              _Vue.set(store, k, this.$data[k]) // 在仓库中创建默认的数据\n            }\n            const item = task[k]\n            const data = store[k]\n            if (!item.update && data._ok_) return false // 数据无需更新\n            if (item.base.length === 0) {\n              fetchTask[k] = item\n            } else {\n              // 将依赖的任务添加进来\n              addBaseTask(item.base)\n            }\n          })\n\n          vueMixinStoreFetch.call(this, fetchTask)\n          function addBaseTask (base) {\n            base.forEach((k) => {\n              fetchTask[k] = task[k]\n            })\n          }\n          function vueMixinStoreFetch (fetchTask) {\n            const fetch = []\n            const queue = Object.keys(fetchTask)\n            const storeUpdate = (k, data) => {\n              Object.defineProperty(data, '_ok_', { // 此数据是否是已经加载过了\n                value: true,\n                enumerable: false, // 不可枚举\n                configurable: false, // 属性不可删除\n                writable: true // 值允许可写\n              })\n              this.$data[k] = store[k] = data\n            }\n\n            queue.forEach((k) => {\n              const item = fetchTask[k]\n              const promise = item.fetch.call(this).then((res) => {\n                storeUpdate(k, res)\n                return res\n              })\n              fetch.push(promise)\n            })\n            return Promise.all(fetch).then((arg) => {\n              Object.keys(task).forEach((k) => {\n                const list = []\n                const item = task[k]\n                if (!item.base.length) return false // 没有依赖任务\n                for (let i = 0; i < item.base.length; i++) {\n                  const index = queue.indexOf(item.base[i])\n                  if (index > -1) {\n                    list.push(arg[index])\n                  } else {\n                    break\n                  }\n                }\n                if (list.length === item.base.length) { // 执行依赖的任务\n                  storeUpdate(k, item.fetch.apply(this, list))\n                }\n              })\n            })\n          }\n        },\n        computed: {\n          $vueMixinStore () {\n            return store\n          }\n        }\n      }\n    }\n  }\n}\n","import install from './install'\nimport VueMixin from './vueMixin'\nexport { default as vueMixinFetchDetail } from './vueMixinFetchDetail'\nexport { default as vueMixinFetchList } from './vueMixinFetchList'\nexport { default as vueMixinStore } from './vueMixinStore'\n\nexport default VueMixin\n\nVueMixin.install = install\n"],"names":["_Vue","install","Vue","installed","obj","Object","prototype","toString","call","arr","k","hasOwnProperty","store","computed","keys","forEach","v","VueMixin","options","mixins","plugins","vm","item","process","env","NODE_ENV","name","Error","msg","assign","utils","isObject","createStore","set","destroyed","vueMixinFetchDetail","fetch","model","key","undefined","fetchList","getListItemIndex","list","length","i","String","listUnwatch","$watch","index","detail","deep","detailUnwatch","to","from","next","params","createComputed","self","fetchDetail","then","$fetchDetail","vueMixinFetchList","pagekey","queryKey","dataSearch","getSearch","query","search","$route","res","init","apply","arguments","arg","event","$router","push","syncQuery","$fetchList","val","oldVal","join","listInit","vueMixinStore","task","defaults","Promise","resolve","unknown","fetchTask","isHas","$data","data","update","_ok_","base","addBaseTask","vueMixinStoreFetch","queue","storeUpdate","defineProperty","promise","all","indexOf"],"mappings":"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"}